<!-- item_list_view.html -->
{% extends 'base.html' %}
{% load staticfiles %}


{% block page_header %}<span class="small">back to <a href="{% url 'home' %}">Kaipuleohone</a> </span> <br> {{ object }}{% endblock page_header %}

{% block content %}	

	<div class="row">
		<!-- Google Map display panel -->
		<div class="col-md-6">
			<div class="row"><div id="map-canvas" style="width: 100%"></div></div>
			<div class="row"><div class="col-md-12">
				<legend>About the Collection</legend>
				<dl class="dl-horizontal">
				{% for k, v in collection_info.items %}
					{% if v %}
						<dt>{{ k }}</dt>
						<dd>  {{ v }} </dd>
					{% endif %}
				{% endfor %}
				</dl>
			</div></div>
		</div>

		<!-- Google Map view controller -->
		<div id="mapped_record_selector" class="col-md-6">
			<legend>{{ records|length }} Records </legend>

			<div class="row ">
				<!-- Page filters -->
				<div class="col-md-12">
					<div class="col-md-2">Page</div>
					<div class="col-md-10">
						{% for i in pager %}
							<div class="page_filter_selector btn" name="page {{ i }}" data-filter=".page_{{ i }}">{{ i }}</div>
						{% endfor %}
						<div class="page_filter_selector btn" name="all" data-filter="*">All</div>
					</div>
				</div>

				<!-- Language filters -->
				{% if collection_info.languages|length > 1 %}
				<div class="col-md-12">
					<div class="col-md-2">Languages</div>
					<div class="col-md-10">
						{% for i in collection_info.languages %}
							<div class="page_filter_selector btn" name="language {{ i }}" data-filter=".{{ i }}">{{ i }}</div>
						{% endfor %}
						<div class="page_filter_selector btn" name="all" data-filter="*">All</div>
					</div>
				</div>
				{% endif %}
				
				<div class="col-md-12 small" style="text-align: right; padding: 1.0em">Showing <span id="curr_page_filter">1</span>.</div>

				<!-- Record list -->
				<div class="col-md-12 ">
					<dl class="dl-horizontal">
					{% for i in records %}
						<div class=""> 						
							<dt><a href="{{ i.record.get_absolute_url }}"> {{ i.record }}</a></dt>
							<dd>{{ i.record.get_title.0.element_data }}</dd> 
							<hr>
						</div>	
						
					{% endfor %}
					</dl>
				</div>
			</div>		
					
		</div>
	</div>

{% endblock content %}

{% block js_script %}
	<script type="text/javascript">
		//Get the coordinates info and data from the records inside the DOM
        var json = {{ mapped_plots|safe }};
        if(json.length > 0){
	 		var mapOptions = {
			        zoom: 12,
			        minZoom:1,
			        center: {lat: parseFloat(json[0].north), lng: parseFloat(json[0].east)}, // Center to first plot in list
			        mapTypeId: google.maps.MapTypeId.HYBRID
			};        	
        }
    </script>
{% endblock js_script %}

{% block js_include %} 
  <!--Google Map js libraries-->
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
  <!-- // <script type="text/javascript" src="https://www.google.com/jsapi"></script> -->

  <!-- Local js -->
  <script src="{% static 'js/map-init.js' %}"></script>
{% endblock js_include %}